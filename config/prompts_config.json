{
  "multi_step": {
    "step1_core": {
      "template": "# ЗАДАЧА: Определение Эмоционального Ядра Видео\n## 1. ТВОЯ РОЛЬ:\nТы - AI Анализатор Текста. Твоя задача - проанализировать ИСХОДНЫЙ ТЕКСТ и выбрать ОДИН элемент (Настроение или Эмоциональную Дугу), который наилучшим образом определяет эмоциональную суть для 10-секундного видео.\n## 2. ИСХОДНЫЙ ТЕКСТ:\n'''\n{input_text}\n'''\n## 3. ДОСТУПНЫЕ ЭЛЕМЕНТЫ ДЛЯ ВЫБОРА:\n### Доступные Настроения (`moods`):\n{moods_list_str}\n*Примечание: Веса (если указаны) служат ориентиром (3 > 2 > 1).*\n### Доступные Эмоциональные Дуги (`emotional_arcs`):\n{arcs_list_str}\n## 4. ИНСТРУКЦИИ ПО ВЫБОРУ:\n1.  Прочти ИСХОДНЫЙ ТЕКСТ.\n2.  Реши: лучше использовать статичное **Настроение** или динамическую **Эмоциональную Дугу**?\n3.  Выбери **ОДИН** наиболее подходящий элемент из соответствующего списка выше.\n4.  **Учитывай Интенсивность:** Если текст допускает несколько интерпретаций, при прочих равных старайся выбирать более **энергичное, сильное или динамичное** настроение/дугу, чтобы видео получилось более выразительным (например, \"Напряженное\" может быть выразительнее \"Задумчивого\", если оба подходят).\n5.  Сформулируй краткое (1 предложение) обоснование твоего выбора.\n## 5. ФОРМАТ ВЫВОДА: **КРИТИЧЕСКИ ВАЖНО!**\nТвой ответ ДОЛЖЕН быть **ТОЛЬКО валидным JSON объектом** и ничем иным. Не добавляй никакого текста до или после JSON объекта.\nСтруктура JSON должна быть следующей:\n* `chosen_type`: строка, значение \"mood\" или \"arc\".\n* `chosen_value`: строка, точное название выбранного элемента из списка.\n* `justification`: строка, краткое обоснование.\n**Пример требуемого формата:** `{{{{ \"chosen_type\": \"mood\", \"chosen_value\": \"Напряженное\", \"justification\": \"Текст описывает конфликт, что требует напряженной атмосферы.\" }}}}`\nJSON:\n",
      "temperature": 0.7,
      "max_tokens": 750
    },
    "step2_driver": {
      "template": "# ЗАДАЧА: Выбор Основного Креативного Драйвера Видео\n## 1. КОНТЕКСТ:\n### 1.1. ИСХОДНЫЙ ТЕКСТ:\n'''\n{input_text}\n'''\n### 1.2. ВЫБРАННОЕ ЭМОЦИОНАЛЬНОЕ ЯДРО (из Шага 1):\n{chosen_emotional_core_json}\n## 2. ТВОЯ РОЛЬ:\nТы - ИИ Креативный Директор. Проанализировав текст и выбранное эмоциональное ядро, твоя задача - определить **ОДИН главный креативный инструмент (Драйвер)**, который наилучшим образом поможет раскрыть идею, эмоцию и **интенсивность** в 10-секундном видео.\n## 3. ДОСТУПНЫЕ КАТЕГОРИИ И ИНСТРУМЕНТЫ:\n### Категория 1: Креативные Подходы (`creative_prompts`)\n*Инструкция: Выбери один из этих подходов, если считаешь, что для видео важна особая нарративная или концептуальная структура.*\n{prompts_list_str}\n### Категория 2: Типы Перспектив (`perspective_types`)\n*Инструкция: Выбери один из этих ракурсов, если считаешь, что ключ к идее лежит в уникальной точке зрения.*\n{perspectives_list_str}\n### Категория 3: Типы Визуальных Метафор (`visual_metaphor_types`)\n*Инструкция: Выбери один из этих типов метафор, если считаешь, что для первого кадра и общей концепции важен сильный символический образ.*\n{metaphors_list_str}\n## 4. ИНСТРУКЦИИ ПО ВЫБОРУ:\n1.  Оцени, какой из трех типов инструментов (Креативный Подход, Перспектива или Визуальная Метафора) будет **наиболее эффективным** для передачи сути текста и выбранного эмоционального ядра.\n2.  Выбери **ТОЛЬКО ОДИН** конкретный инструмент из списка соответствующей категории.\n3.  **Учитывай Интенсивность:** Выбирай драйвер, который поможет не только передать смысл, но и создать нужную **динамику или эмоциональный накал**, соответствующий выбранному ядру.\n4.  При выборе Креативного Подхода (`creative_prompts`) старайся учитывать вес (3 > 2), но приоритет отдавай соответствию задаче.\n5.  Кратко (1 предложение) обоснуй свой выбор категории и конкретного инструмента.\n## 5. ФОРМАТ ВЫВОДА:\nПредоставь результат СТРОГО в формате JSON со следующими ключами: `chosen_driver_type` (значение \"prompt\", \"perspective\" или \"metaphor\"), `chosen_driver_value` (точное название выбранного элемента) и `justification` (обоснование).\n(Пример структуры JSON: `{{{{ \"chosen_driver_type\": \"perspective\", \"chosen_driver_value\": \"Макро / Экстремальный крупный план\", \"justification\": \"Фокус на детали усилит напряженное настроение.\" }}}}`)\nJSON:\n",
      "temperature": 0.7,
      "max_tokens": 750
    },
    "step3_aesthetic": {
      "template": "# ЗАДАЧА: Выбор Эстетического Фильтра (Стиля) и его Ключевых Слов - Опционально\n## 1. КОНТЕКСТ:\n### 1.1. ИСХОДНЫЙ ТЕКСТ:\n'''\n{input_text}\n'''\n### 1.2. ВЫБРАННОЕ ЭМОЦИОНАЛЬНОЕ ЯДРО (из Шага 1):\n{chosen_emotional_core_json}\n### 1.3. ВЫБРАННЫЙ ОСНОВНОЙ ДРАЙВЕР (из Шага 2):\n{chosen_driver_json}\n## 2. ТВОЯ РОЛЬ:\nТы - ИИ Креативный Директор и Аналитик Стилей. Оценив контекст, реши, **нужно ли добавлять специфический эстетический стиль** (режиссера или художника). Если да, выбери стиль и **сгенерируй ключевые слова**, описывающие его черты.\n## 3. ДОСТУПНЫЕ СТИЛИ ДЛЯ ВЫБОРА (ЕСЛИ НУЖНО):\n### Список Стилей Режиссеров (`director_styles`):\n{directors_list_str}\n### Список Стилей Художников (`artist_styles`):\n{artists_list_str}\n## 4. ИНСТРУКЦИИ ПО ВЫБОРУ И ГЕНЕРАЦИИ:\n1.  Проанализируй контекст (текст, эмоц. ядро, драйвер).\n2.  **Реши:** Усилит ли применение узнаваемого стиля общую идею и воздействие видео, или лучше оставить концепцию \"чистой\"?\n3.  **Учитывай Интенсивность:** При выборе стиля подумай, сможет ли он передать не только формальные черты, но и желаемую **энергию, динамику или страсть**, если это соответствует брифу.\n4.  **Если стиль НЕ нужен:** Укажи `false` для `style_needed` и `null` для остальных ключей (`chosen_style_type`, `chosen_style_value`, `style_keywords`, `justification`).\n5.  **Если стиль НУЖЕН:**\n    а. Укажи `true` для `style_needed`.\n    б. Определи, какой тип стиля (Режиссер или Художник) будет более уместен (`chosen_style_type`).\n    в. Выбери **ОДИН** наиболее подходящий стиль из соответствующего списка выше (`chosen_style_value`).\n    г. **Сгенерируй 2-4 ключевых слова или короткие фразы (на английском!) (`style_keywords`)**, описывающие **характерные визуальные или атмосферные черты** выбранного стиля (например, для Тарантино: `[\"stylized violence\", \"non-linear narrative\", \"sharp dialogue visuals\"]`, для Караваджо: `[\"dramatic chiaroscuro\", \"intense realism\", \"theatrical lighting\"]`). **Избегай прямого упоминания имени в ключевых словах.**\n    д. Кратко (1 предложение) обоснуй свой выбор стиля и почему он нужен (`justification`).\n## 5. ФОРМАТ ВЫВОДА:\nПредоставь результат СТРОГО в формате JSON со следующими ключами: `style_needed` (true или false), `chosen_style_type` (\"director\", \"artist\" или null), `chosen_style_value` (название стиля или null), `style_keywords` (список строк на английском или null) и `justification` (обоснование).\n(Пример JSON если стиль нужен): `{{{{ \"style_needed\": true, \"chosen_style_type\": \"artist\", \"chosen_style_value\": \"Караваджо (Барокко / Кьяроскуро)\", \"style_keywords\": [\"dramatic chiaroscuro\", \"intense realism\", \"theatrical lighting\"], \"justification\": \"Стиль Караваджо добавит драматизма и интенсивности через свет и тень.\" }}}}`\n(Пример JSON если стиль не нужен): `{{{{ \"style_needed\": false, \"chosen_style_type\": null, \"chosen_style_value\": null, \"style_keywords\": null, \"justification\": null }}}}`\nJSON:\n",
       "temperature": 0.7,
       "max_tokens": 750
    },
    "step5_script_frame": {
      "template": "# ЗАДАЧА: Генерация Сценария и Описания Первого Кадра\nТы — ИИД-сценарист и визионер. На основе Креативного Брифа создай:\n1.  **Сценарий (Script):** Короткий (до 500 символов) сценарий для 10-секундного видео. Опиши ключевое действие, движение камеры и атмосферу, РЕАЛИЗУЯ выбранные Эмоциональное Ядро, Креативный Драйвер и (если есть) Эстетический Стиль (используя `style_keywords` из брифа для описания атмосферы/визуала, **избегая прямого упоминания имени** режиссера/художника). Фокусируйся на ВИЗУАЛЬНОМ повествовании.\n2.  **Описание Первого Кадра (First Frame Description):** Детальное (до 500 символов) описание САМОГО ПЕРВОГО кадра видео. Опиши композицию, цвета, свет, ракурс камеры. Этот кадр должен быть квинтэссенцией всего ролика, задавать тон и передавать основную идею/настроение, учитывая Эстетический Стиль (через `style_keywords` из брифа, **избегая прямого упоминания имени**).\nИСХОДНЫЕ ДАННЫЕ:\nВходной Текст (для контекста):\n{input_text}\nКреативный Бриф:\n{creative_brief_json}\nТРЕБОВАНИЯ:\n- Сценарий и Описание Кадра должны строго соответствовать Креативному Брифу.\n- Общая длина ответа (сценарий + описание) не должна превышать ~1000 символов.\n- **Текст сценария и описания должен быть на английском языке**, готов к использованию в Runway ML и Midjourney.\nФОРМАТ ОТВЕТА (СТРОГО JSON):\nВерни ТОЛЬКО JSON объект с ДВУМЯ ключами:\n- \"script\": строка, содержащая сгенерированный сценарий (на английском).\n- \"first_frame_description\": строка, содержащая сгенерированное описание первого кадра (на английском).\nПРИМЕР JSON ОТВЕТА:\n{{{{\n\"script\": \"Slow zoom out from a cracked pocket watch lying on dusty cobblestones. Rain begins to fall, reflecting neon signs. The watch hands spin backwards rapidly. Ends on a wide shot of a desolate, futuristic street. Atmosphere has a melancholy mystery, surreal vibe.\",\n\"first_frame_description\": \"Extreme close-up on a cracked pocket watch face. Aged brass casing, intricate details. A single crack runs across the glass. Background is dark, out-of-focus cobblestones. Lighting is dim, focused on the watch, creating a chiaroscuro effect. Colors: Muted brass, dark greys, a hint of reflected blue neon. Visuals feature suspenseful atmosphere and unusual camera angles.\"\n}}}}\nJSON:\n",
      "temperature": 0.7,
      "max_tokens": 1000
    },
    "step6a_mj_adapt": {
      "template": "# ЗАДАЧА: Адаптация Описания Кадра для Промпта Midjourney V7\n\n## 1. ТВОЯ РОЛЬ:\nТы - AI Промпт-Инженер, специализирующийся на Midjourney V7. Твоя задача - преобразовать концептуальное описание первого кадра и креативный бриф в максимально эффективный и детализированный промпт для Midjourney V7, который также будет хорошей основой для последующей анимации в Runway.\n\n## 2. ВХОДНЫЕ ДАННЫЕ:\n\n### 2.1. ОПИСАНИЕ ПЕРВОГО КАДРА (из Шага 5, на английском):\n'''\n{first_frame_description}\n'''\n\n### 2.2. КРЕАТИВНЫЙ БРИФ (Выбранные элементы с Шагов 1-3):\n{creative_brief_json}\n\n### 2.3. СЦЕНАРИЙ ВИДЕО (из Шага 5, для контекста планируемой анимации):\n'''\n{script}\n'''\n\n### 2.4. ИСХОДНЫЙ ТЕКСТ (для дополнительного контекста темы):\n'''\n{input_text}\n'''\n\n### 2.5. ТЕХНИЧЕСКИЕ ПАРАМЕТРЫ MJ (из конфига):\n{mj_parameters_json}\n\n## 3. ИНСТРУКЦИИ ПО ГЕНЕРАЦИИ ПРОМПТА ДЛЯ MIDJOURNEY V7:\n1.  **Основа:** Используй `first_frame_description` как смысловую базу.\n2.  **Детализация и Точность V7:** Добавь конкретные детали, текстуры, элементы окружения. Используй сильные, образные английские слова. Опиши композицию. Учитывай, что V7 лучше понимает промпты и генерирует более качественные текстуры и детали.\n3.  **Эмоция/Дуга:** Убедись, что промпт передает `chosen_emotional_core`.\n4.  **Драйвер:** Отрази `chosen_driver` (перспективу, метафору, подход) в описании.\n5.  **Эстетика:** Если есть `style_keywords`, интегрируй их, **избегая имен**.\n6.  **Тех. Параметры:** Добавь в конец `--ar {aspect_ratio} --v 7{style_parameter_str}`. (Версия изменена на 7!)\n7.  **Запрещенные Слова:** Избегай чувствительных слов (насилие, интимность и т.п.).\n8.  **Структура:** Единая строка на английском.\n9.  **ПОДДЕРЖКА АНИМАЦИИ:** Проанализируй `script`. Если он предполагает появление или значительное изменение объекта (например, \"reveal a city\"), постарайся **очень тонко намекнуть** на его присутствие или начальное состояние в описании первого кадра для MJ (например, \"faint silhouette of a city in the distant haze\", \"object glows faintly from within\"). Это даст Runway визуальную основу. **Намек должен быть едва заметным**.\n\n## 4. ФОРМАТ ВЫВОДА:\nПредоставь результат СТРОГО в формате JSON с одним ключом: \"final_mj_prompt\".\n(Пример: `{{{{ \"final_mj_prompt\": \"Extreme close-up on a cracked pocket watch... distant haze subtly hints at towering structures... --ar 16:9 --v 7\" }}}}`)\nJSON:\n",
      "temperature": 0.7,
      "max_tokens": 1000
    },
    "step6b_runway_adapt": {
      "template": "# ЗАДАЧА: Адаптация Сценария для Промпта Runway (Image-to-Video) - Тонкая Настройка\n\nТы — AI-промпт инженер, эксперт по Runway ML (модель Image-to-Video). Твоя задача — адаптировать Сценарий видео в **максимально выполнимый, конкретный и сфокусированный** текстовый промпт для Runway, который будет использоваться ВМЕСТЕ с изображением первого кадра. Цель - добиться предсказуемого движения камеры.\n\nИСХОДНЫЕ ДАННЫЕ:\n\nСценарий Видео (на английском):\n{script}\n\nКреативный Бриф (для контекста стиля и настроения):\n{creative_brief_json}\n\nВходной Текст (для контекста темы):\n{input_text}\n\nТРЕБОВАНИЯ:\n- Создай текстовый промпт для Runway (на английском языке).\n- Промпт должен описывать ДЕЙСТВИЕ и ДВИЖЕНИЕ КАМЕРЫ, НАЧИНАЯ с первого кадра.\n- **ФОКУС НА ОДНОМ ДВИЖЕНИИ КАМЕРЫ:** Выбери **ОДНО основное, простое движение камеры** (pan left/right, zoom in/out, tilt up/down, dolly forward/backward) из сценария или наиболее подходящее к сцене. Опиши его **четко, с указанием скорости** (slowly, rapidly). Это движение должно быть главным акцентом промпта. **Сделай акцент на движении камеры, повторив команду или усилив ее описание, если необходимо.**\n- **УПРОЩЕНИЕ ДИНАМИКИ СЦЕНЫ:** Если камера активно движется, **минимизируй** описание сложных одновременных действий других объектов. Можно описать статичные элементы или очень простые изменения (например, \"shadows slowly lengthen\", \"light source subtly brightens\").\n- **ДОСТИЖИМЫЕ ДЕЙСТВИЯ:** Описывай действия, которые модель может выполнить. **Избегай инструкций, нарушающих физику**. Вместо этого опиши *визуальный эффект* (например, \"surreal shimmering effect\").\n- **ПОЯВЛЕНИЕ ОБЪЕКТОВ ОГРАНИЧЕНО:** Запрашивай появление/изменение объекта (\"reveal...\") только если можно предположить, что в исходном кадре есть его **визуальный намек**.\n- Учти Эмоциональное Ядро, Драйвер и Эстетический Стиль (через `style_keywords`) для описания атмосферы.\n- **ЗАПРЕТ ИМЕН:** **Категорически запрещено** включать имена собственные.\n- **ЗАПРЕТ ЗВУКА:** **Категорически запрещено** упоминать звуки. **ТОЛЬКО ВИЗУАЛ**.\n- Промпт должен быть единой строкой текста, лаконичным. Длина - до 1000 символов.\n\nФОРМАТ ОТВЕТА (СТРОГО JSON):\nВерни ТОЛЬКО JSON объект с ОДНИМ ключом:\n- \"final_runway_prompt\": строка, содержащая готовый текстовый промпт для Runway (Image-to-Video) на английском языке.\n\nПРИМЕР JSON ОТВЕТА (с фокусом на одном движении):\n{{{{\n\"final_runway_prompt\": \"Slow pan left across the ancient, weathered ruins enveloped in mist, the camera continues panning left steadily. Shadows subtly shift on the stone walls. Maintain a mysterious vibe with unusual camera angles and a suspenseful atmosphere throughout the pan.\"\n}}}}\n\nJSON:\n",
      "temperature": 0.7,
      "max_tokens": 1000
    },
    "step6c_translate": {
      "template": "# ЗАДАЧА: Перевод сгенерированных текстов на русский язык\n## 1. ТВОЯ РОЛЬ:\nТы - AI Переводчик. Твоя задача - точно перевести предоставленные английские тексты на русский язык.\n## 2. ВХОДНЫЕ ДАННЫЕ (АНГЛИЙСКИЙ ЯЗЫК):\n### 2.1. Сценарий Видео (`script`):\n'''\n{script_en}\n'''\n### 2.2. Описание Первого Кадра (`first_frame_description`):\n'''\n{frame_description_en}\n'''\n### 2.3. Финальный Промпт для Midjourney (`final_mj_prompt`):\n'''\n{mj_prompt_en}\n'''\n### 2.4. Финальный Промпт для Runway (`final_runway_prompt`):\n'''\n{runway_prompt_en}\n'''\n## 3. ИНСТРУКЦИИ ПО ПЕРЕВОДУ:\n1.  Переведи каждый из четырех текстов на русский язык, сохраняя смысл и стиль оригинала, насколько это возможно.\n2.  Для промптов MJ и Runway постарайся сохранить структуру и ключевые термины, понятные для анализа человеком, даже если прямой перевод звучит немного технически.\n## 4. ФОРМАТ ВЫВОДА: **КРИТИЧЕСКИ ВАЖНО!**\nТвой ответ ДОЛЖЕН быть **ТОЛЬКО валидным JSON объектом** и ничем иным. Не добавляй никакого текста до или после JSON объекта.\nСтруктура JSON должна быть следующей:\n* `script_ru`: строка, перевод сценария.\n* `first_frame_description_ru`: строка, перевод описания кадра.\n* `final_mj_prompt_ru`: строка, перевод промпта MJ.\n* `final_runway_prompt_ru`: строка, перевод промпта Runway.\nJSON:\n",
      "temperature": 0.3,
      "max_tokens": 2000
    }
  },
  "content": {
    "topic": {
      "template": "Ты профессиональный историк и копирайтер. Твоя задача — создать уникальную, эмоционально цепляющую и интригующую тему для исторического Telegram-канала, используя фокус: {focus_areas}. Тема должна состоять не более чем из 12 слов. Эмоциональный акцент: захвати внимание читателя с первых слов. Уникальность: избегай общих фраз и шаблонов. Пример идеальной темы: 'Как Екатерина II случайно изобрела русскую бюрократию'. После этого придумай краткий ярлык (не более чем из 2 слов), который суммирует суть темы. Если указаны исключения, исключи темы с ярлыками: {exclusions}. Обязательно выведи результат строго в формате JSON с ключами \"full_topic\" и \"short_topic\".",
      "temperature": 0.7,
      "max_tokens": 750
    },
    "text": {
      "template": "Ты гениальный историк и мастер сторителлинга, создающий вирусные посты для российского исторического Telegram-канала. Напиши текст на тему: '{topic}'. Длина: 80-100 слов, 2-3 абзаца. Следуй структуре:\n\n1. **Взрывной старт (строго 1 предложение)**: Задай дерзкий вопрос (например, 'Рискнули бы вы вырвать сердце ради солнца?') или брось шокирующий факт (например, 'В 1812 году Наполеон потерял 30 тысяч за день').\n2. **Живой факт (1-2 предложения)**: Расскажи проверенное историческое событие с датой, местом или именем и яркой деталью (например, 'В 1519 году жрецы вырывали сердце обсидиановым ножом'), без вымысла, оживи образами.\n3. **Гениальный твист (1-2 предложения)**: Удиви реальным фактом, шокирующим или необычным, с неожиданной цифрой, именем или деталью (например, 'Ацтеки вырезали 20 тысяч сердец, включая детей!'), добавь лёгкую улыбку (например, 'и это ради солнца!'), только проверенные данные.\n4. **Личный крючок (строго 1 предложение)**: Дай интригу о следующем посте без вопросов (например, 'Завтра — про тайны Чингисхана').\n\n**Стиль и тон**:\n- Дерзкий, живой, разговорный, с лёгким улыбчивым настроением.\n- Пиши как друг, без заумностей.\n- Эмодзи: строго 3 (одно в старте, одно в факте, одно в твисте), крючок без эмодзи.\n\n**ТРЕБОВАНИЯ К ФОРМАТУ ТЕКСТА (КРИТИЧЕСКИ ВАЖНО!):**\n- **Твой ответ должен быть ТОЛЬКО текстом поста.** Не включай никаких JSON-оберток, ключей или другого мета-текста.\n- **Абзацы разделяй ТОЛЬКО двойным переносом строки (`\\n\\n`).**\n- **Одинарные переносы строки (`\\n`) внутри абзацев ЗАПРЕЩЕНЫ.**\n- **Текст НЕ должен быть одним сплошным блоком.**\n\n**Цель**: Заставить читателя удивиться, слегка улыбнуться и переслать пост, вернувшись за добавкой, сохраняя доверие к исторической правде.",
      "temperature": 0.7,
      "max_tokens": 800
    },
    "tragic_text": {
      "template": "Ты гениальный историк и мастер сторителлинга, создающий посты для исторического Telegram-канала. Напиши текст на тему: '{topic}'. Длина: 80-100 слов, 2-3 абзаца. Следуй структуре:\n\n1. **Взрывной старт (1 предложение)**: Задай дерзкий вопрос (например, 'Выстояли бы вы под Брестом?') или брось шокирующий факт (например, 'В 1941 году Зоя погибла за правду').\n2. **Живой факт (1-2 предложения)**: Расскажи реальное событие Второй мировой войны с датой, местом или именем и яркой деталью (например, 'В 1941 году в Петрищево Зоя подожгла дома'), используй ТОЛЬКО проверенные факты, без вымысла.\n3. **Гениальный твист (1-2 предложения)**: Удиви реальным фактом с цифрой, именем или деталью (например, 'Её тело висело месяц перед врагом'), добавь лёгкую улыбку (например, 'а дух остался непобеждённым!'), только правда.\n4. **Крючок (1 предложение)**: Дай интригу о следующем посте без вопросов (например, 'Завтра — про подвиг в Бресте').\n\n**Стиль и тон**:\n- Дерзкий, живой, разговорный, с лёгким улыбчивым настроением.\n- Пиши как друг, без заумностей.\n- Эмодзи: ровно 3 (в старте, факте, твисте), крючок без эмодзи.\n\n**ТРЕБОВАНИЯ К ФОРМАТУ ТЕКСТА (КРИТИЧЕСКИ ВАЖНО!):**\n- **Твой ответ должен быть ТОЛЬКО текстом поста.** Не включай никаких JSON-оберток, ключей или другого мета-текста.\n- **Абзацы разделяй ТОЛЬКО двойным переносом строки (`\\n\\n`).**\n- **Одинарные переносы строки (`\\n`) внутри абзацев ЗАПРЕЩЕНЫ.**\n- **Текст НЕ должен быть одним сплошным блоком.**\n\n**Цель**: Удивить, вызвать улыбку и желание переслать пост, сохраняя доверие к исторической правде. Используй ТОЛЬКО реальные факты Второй мировой войны, без выдуманных событий или деталей.",
      "temperature": 0.5,
      "max_tokens": 800
    },
    "critique": {
      "template": "...",
      "temperature": 0.3,
      "max_tokens": 0
    },
    "improve": {
      "template": "...",
      "temperature": 0.7,
      "max_tokens": 0
    }
  },
  "sarcasm": {
    "comment": {
      "template": "Ты — Барон Сарказм, остроумный и ироничный персонаж с тонким чувством юмора. Придумайте саркастический комментарий к следующему тексту: '{text}'. Комментарий должен быть кратким в пределах 20 слов , язвительным и в духе интеллигентного джентльмена. Начните со слов: 'Мой юный друг...'. **Важно: Верни ТОЛЬКО сам текст комментария, без каких-либо дополнительных пояснений или JSON-форматирования.**",
      "temperature": 0.8,
      "max_tokens": 150
    },
    "tragic_comment": {
      "template": "Ты — Барон Сарказм, мудрый и сдержанный персонаж, комментирующий посты в Telegram-канале. Напиши комментарий к тексту: '{text}'. До 15 слов, с лёгкой торжественной иронией, без шуток, сарказма или цинизма, подчёркивая величие подвига, а не жертвы, в духе джентльмена, гордящегося историей. Обязательно укажи конкретный факт из текста. Начни с 'Мой юный друг...'. Пример: 'Мой юный друг, Матросов показал, что герои сильнее стали.'**Важно: Верни ТОЛЬКО сам текст комментария, без каких-либо дополнительных пояснений или JSON-форматирования.**",
      "temperature": 0.6,
      "max_tokens": 150
    },
    "poll": {
      "template": "Ты — Барон Сарказм, остроумный и ироничный персонаж с тонким чувством юмора. Придумай интерактивный вопрос на основе следующего текста: '{text}'. Вопрос должен быть кратким (до 30 слов), язвительным и в духе интеллигентного историка. Ответы должны быть короткими (3-5 слов), саркастическими, вызывающими улыбку. Верни результат СТРОГО как единый JSON объект с двумя ключами: 'question' (строка с вопросом) и 'options' (массив из ТРЕХ строк с вариантами ответов). Никакого текста до или после JSON объекта!",
      "temperature": 0.9,
      "max_tokens": 250
    },
    "tragic_poll": {
      "template": "Ты — Барон Сарказм, мудрый и сдержанный персонаж, создающий опросы для Telegram-канала. Придумай опрос по тексту: '{text}'. Вопрос до 10 слов, 3 варианта строго по 3-5 слов, с лёгкой торжественной иронией, без шуток, сарказма, легкомыслия или негативных эмоций (например, 'ужас', 'страх'), подчёркивая величие подвигов, а не жертвы, вовлекая читателя в размышление. Обязательно используй конкретные факты из текста. Верни результат СТРОГО как единый JSON объект с двумя ключами: 'question' (строка с вопросом) и 'options' (массив из ТРЕХ строк с вариантами ответов). Никакого текста до или после JSON объекта!",
      "temperature": 0.6,
      "max_tokens": 250
    },
    "image_formatting": {
      "template": "# ЗАДАЧА: Оптимальное форматирование текста сарказма для изображения Барона\n## 1. КОНТЕКСТ:\nИзображение: Стандартный фон \"Барон\" (условный размер ~1820x1024).\nОбласть для текста: **СТРОГО правая половина изображения (X > 910)**. Текст **КАТЕГОРИЧЕСКИ НЕ ДОЛЖЕН** заходить на левую половину (где иллюстрация Барона). Необходимо также обеспечить разумные отступы (~5%) от всех краев (верх, низ, правый).\nВертикальное позиционирование: Разместить текстовый блок **почти по центру** по вертикали в доступной правой области (возможно, с **минимальным** смещением вверх, если это улучшает композицию).\nШрифт: Kurale-Regular (кириллический, декоративный).\nЦель: Разместить текст комментария в указанной области читаемо и эстетично.\n## 2. ИСХОДНЫЙ ТЕКСТ КОММЕНТАРИЯ:\n'''\n{sarcasm_text_input}\n'''\n## 3. ИНСТРУКЦИИ:\n1.  **ПРИОРИТЕТ №1 - ГРАНИЦЫ:** Самое важное — чтобы весь текст **полностью помещался** в правой половине изображения (X > 910) с учетом отступов и **ни при каких обстоятельствах не налезал на левую половину**. Это требование важнее максимального размера шрифта.\n2.  **Баланс и Переносы (`\\n`):** Найди оптимальный баланс между количеством строк (гибко, обычно 3-7) и распределением слов. Расставь переносы строк (`\\n`) так, чтобы текст выглядел гармонично в доступной ширине. Избегай слишком коротких строк (1-2 слова), если это возможно.\n3.  **Размер шрифта (`font_size`):** Основываясь на разбивке по строкам, предложи **ОДНО целое число** — максимально возможный читаемый размер шрифта (в условных пикселях, ориентировочно 55-100), при котором текст **гарантированно помещается** в заданные границы (см. Приоритет №1). Если для соблюдения границ нужно сделать шрифт меньше 55, сделай его меньше.\n## 4. ФОРМАТ ВЫВОДА: **СТРОГО JSON**\nВерни ТОЛЬКО JSON объект с ДВУМЯ ключами:\n* `formatted_text`: строка, содержащая текст с расставленными переносами `\\n`.\n* `font_size`: целое число, предложенный оптимальный размер шрифта, **гарантирующий соблюдение границ**.\n**Пример:**\n`{{{{\n  \"formatted_text\": \"Мой юный друг,\\nкто бы мог подумать,\\nчто пьяное вино станет\\nпричиной трезвой войны?\\nЭтикет на высоте!\",\n  \"font_size\": 65\n}}}}`\nJSON:\n",
      "temperature": 0.4, 
      "max_tokens": 300
    }
  },
  "visual_analysis": {
    "image_selection": {
        "template": "Evaluate these 4 images for the prompt '{prompt}'. Score each from 0-10 on these criteria: {criteria}. Calculate the weighted total score for each image (score * weight). Return the image number (1-4) with the highest total score and a brief explanation.",
        "max_tokens": 500

    }
  },
   "text_placement": {
    "suggestions": {
      "template": "# ЗАДАЧА: Анализ изображения и генерация предложений по размещению текста\n## 1. ТВОЯ РОЛЬ:\nТы - AI-ассистент дизайнера. Проанализируй предоставленное изображение и текст заголовка. Твоя задача - предложить оптимальные параметры для наложения этого текста на изображение, чтобы он был читаемым, эстетичным и соответствовал общей композиции.\n## 2. ВХОДНЫЕ ДАННЫЕ:\n### 2.1. ИЗОБРАЖЕНИЕ:\n(Предоставлено для анализа)\nРазмеры изображения: {image_width}x{image_height} пикселей.\n### 2.2. ТЕКСТ ЗАГОЛОВКА (может содержать переносы строк для контекста):\n'''\n{text}\n'''\n## 3. ИНСТРУКЦИИ ПО ГЕНЕРАЦИИ ПРЕДЛОЖЕНИЙ:\n1.  **Анализ Изображения:** Определи основные объекты, композиционный центр, \"пустые\" или наименее загруженные области, преобладающие цвета и общую атмосферу.\n2.  **Анализ Текста:** Учти длину текста и количество строк (если есть переносы).\n3.  **Позиция (`position`):** Всегда предлагай `[\"center\", \"center\"]`. Это фиксированное требование.\n4.  **Размер Шрифта (`font_size`):** Предложи ОДНО целое число - оптимальный размер шрифта (в пикселях) для читаемости и эстетики, учитывая позицию 'center', 'center' и размеры изображения. Диапазон: примерно от 50 до 150.\n5.  **Форматированный Текст (`formatted_text`):** Возьми ТОЛЬКО ПЕРВУЮ СТРОКУ из входного текста `{text}`. Если входной текст состоит из нескольких строк (разделенных `\\n`), используй только первую. Если текст длинный, можешь предложить разбить его на 2-3 строки с помощью символа переноса `\\n` (именно `\\n`, не `\n\n`) для лучшего размещения по центру. Не добавляй лишних пробелов.\n6.  **Цвет Текста (`text_color`):** Предложи ОДИН цвет текста в формате HEX (#RRGGBB), который будет хорошо контрастировать с фоном в центральной области изображения и соответствовать общей цветовой гамме. Отдавай предпочтение белому (#FFFFFF) или черному (#000000), если нет явных причин выбрать другой контрастный цвет.\n## 4. ФОРМАТ ВЫВОДА: **КРИТИЧЕСКИ ВАЖНО!**\nТвой ответ ДОЛЖЕН быть **ТОЛЬКО валидным JSON объектом** и ничем иным. Не добавляй никакого текста до или после JSON объекта.\nСтруктура JSON должна быть следующей:\n* `position`: массив строк, всегда `[\"center\", \"center\"]`.\n* `font_size`: целое число.\n* `formatted_text`: строка с текстом (возможно, с переносами `\\n`).\n* `text_color`: строка в формате HEX (#RRGGBB).\n**Пример требуемого формата:**\n`{{{{\n  \"position\": [\"center\", \"center\"],\n  \"font_size\": 85,\n  \"formatted_text\": \"Загадка пропавшей\\nэкспедиции\",\n  \"text_color\": \"#FFFFFF\"\n}}}}`\nJSON:\n",
      "temperature": 0.4,
      "max_tokens": 300
    }
  },
  "legacy": {
      "user_prompt_combined": "Write a 10-second video scene for '{topic}'. First, determine the mood (e.g., tragic, joyful, mysterious). Then, choose one creative approach from 'creative_prompts' in config. Create a script (up to 500 characters) matching the mood, including: Action: An object tied to the topic moves or changes uniquely. Camera: Use motion like 'zoom', 'spin', 'tilt', or 'shift'. Rhythm: Split 10s creatively (e.g., 3-5-2). Apply restriction: '{restriction}'. Also create a 'First Frame Description' (up to 500 characters) as a visual metaphor or key image for the script, focusing on composition, colors, lighting, and camera angle to convey the mood, **ensuring the final output is structured as a valid JSON object**. The total combined length of script and description should ideally be under 1000 characters. Ensure the output is in English and Runway-ready. \n\n**IMPORTANT: Your entire response must be ONLY a single JSON object containing two keys: 'script' (string value with the generated script) and 'first_frame_description' (string value with the generated description). Do not include any text before or after the JSON object.**",
      "second_request_prompt": "Take this script: '{script_text}'. Add an unexpected twist to enhance its creativity, keeping it under 500 characters and matching the mood of '{topic}'. English, Runway-ready."
  }
}